#include<iostream>
using namespace std;

int sumaMatrice(int*, int){
	_asm{
		mov ebx, 0
			mov edx,0
			mov edi, 0
			mov ecx, [ebp + 8]
			push ebx
		fori:cmp edi, [ebp + 12]
			 jae endfori
			 mov esi, 0

		 forj : cmp esi, [ebp + 12]
				jae endforj

				mov eax, [ebp+12]
				mul edi
				add eax,esi
				mov ebx, [ecx + 4*eax]

				mov edx, [esp]
				add edx,ebx
				mov dword ptr[esp],edx

				inc esi
				jmp forj
			endforj :
		inc edi
			jmp fori
		endfori :
		
		add esp,4
		mov eax,edx

	}
}

int main(){
	int s, a[4][4], j, i;
	for (i = 0; i < 4; i++)
	for (j = 0; j < 4; j++)
		a[i][j] = i;
	int *p;
	p = a[0];
	_asm{
		lea eax, a
			push 4
			push eax
			call sumaMatrice
			add esp, 8
			mov s, eax
	}
	for (i = 0; i < 4; i++)
	{for (j = 0; j < 4; j++)
		cout << a[i][j] << " ";
	cout << '\n';
}
		cout << s<<'\n';
		return 0;
	}